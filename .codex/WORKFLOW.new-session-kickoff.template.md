# 新会话启动工作流模板（Plan → Act）

> 用途：当你打开一个新的会话时，用最短输入把上下文“喂给”AI，并强制先规划（Plan），你确认后再执行（Act）。
> 适用：需求不确定 / 任务复杂 / 涉及多模块（Client/Server/Protocol/Data/Unity）。

---

## 元信息
- 标题：
- 日期：
- 目标（可验收）：
- 约束（不能改什么/必须兼容什么/时间预算）：
- 涉及模块/目录：
- 相关文件（路径/入口）：
- 相关日志/截图：

---

## 1) 新会话第一条消息（直接复制粘贴）

```text
PLAN: <用 1-3 句话描述你要解决的问题与验收标准>

请严格按 `.codex/AGENTS.md` 的 Plan Mode 执行：
1) 先给至少 2 套方案（含优缺点/成本/风险/推荐）
2) 输出待确认 checklist
3) 我回复 “ACT: 执行方案X” 后你再改代码/跑命令

现状补充：
- 目标：
  - 在不引入无关改动的前提下，解决当前描述的问题，使其达到「功能可用 / 流程可走通 / 状态一致」的验收标准
  - 确保改动结果清晰、可回滚、可审查，不影响现有主流程与稳定性
- 约束：
  - 严格遵循 `.codex/AGENTS.md` 定义的 Plan Mode 流程，在收到明确的 `ACT` 指令前不修改代码、不执行命令
  - 改动范围限定在与当前问题直接相关的最小集合内，避免无关重构或风格性调整
  - 不引入新的外部依赖或破坏性变更
- 相关路径：
- 我已尝试：
- 当前报错/日志片段：
```

---

## 2) AI 在 Plan Mode 必须交付的内容（验收清单）

- [ ] 复述需求与验收标准（避免理解偏差）
- [ ] 列出关键未知点（需要我补充的信息）
- [ ] 提供至少 2 套方案（含：优缺点/成本/风险/推荐）
- [ ] 给出模块拆解与推进步骤（里程碑）
- [ ] 明确哪些步骤会改哪些文件（大致范围）
- [ ] 输出 “待我确认” checklist（我确认后进入 Act）

---

## 3) Act Mode 启动口令（我确认方案后发）

```text
ACT: 执行方案 <A/B/...>
按你在 Plan Mode 给出的步骤推进，遇到阻塞再向我提问。
```

---

## 4) 新会话快速上手信息采集（可选：让 AI 跑命令前你先给它）

> 如果你希望 AI 少跑命令、直接进入分析，你可以把下面信息手动贴给它：

- `git status --short` 输出：
- Unity 相关（如有）：
  - 当前场景名/Prefab Stage：
  - Console 最新错误（前 20 行）：
  - 关键对象层级路径（如 ButtonPlay 的路径）：
- Server 相关（如有）：
  - 最新 server log 错误片段：
  - 端口/配置文件（Settings/Config）：
- Protocol 相关（如有）：
  - 本次改动涉及的 message 名称：
  - proto diff（或相关字段列表）：

---

## 5) 常用对话控制（防跑偏）

- `FREEZE`：停止一切写入/执行，只做分析
- `DIFF`：只展示改动点/风险点（不继续扩改）
- `PLAN:`：只规划不动手
- `ACT:`：按确认方案动手
- `Code Optimization`:我希望在不改变任何现有功能与行为的前提下，对代码进行结构与可读性层面的优化：
  - 仅调整代码顺序、分组与排版，不引入新逻辑、不删除已有逻辑
  - 按照国外高质量开源项目的常见实践，对类结构进行重排（字段、生命周期方法、公共方法、私有方法等）
  - 通过清晰的分区、合理的顺序与一致的风格，提高整体可读性与维护性
  - 目标是让代码在“第一次阅读时就能被快速理解”，并具备专业、克制、工程化的美感
  请以 **结构优化 / 可读性优化 / 风格对齐** 为唯一目标进行分析与规划。


